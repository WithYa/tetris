<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet/less" type="text/css" href="../css/game.less">
    <script type="text/javascript" src="../js/less.js"></script>
</head>
<body>
    <header id="head" class="head">俄罗斯方块</header>
    <section id="cbox" class="cbox">
        <div class="gamebox" id="gamebox">
            <canvas class="game" id="canvas"  width="500px" height="700px">
            </canvas>
        </div>
            <div class="console">
                <div class="sign"></div>
                <div class="ctrl">
                    <button class="keyss">开始</button>
                    <button class="keyend">结束游戏</button>
                    <button class="reset">重置</button>
                    <p class="scorebox">得分：<span class="score">0</span></p>
                    <button class="delline">消除行数: <span class="dlnumber">0</span></button>
                    <button class="grade">等级:<span class="gradenumber">0</span></button>
                </div>
            </div>
    </section>
    <footer class="key">
        <div class="lrbox">
            <button class="left">←</button>
            <button class="up">旋转</button>
            <button class="right">→</button>
        </div>
        <button class="down">↓</button>
    </footer>
    <script type="text/javascript">
        //获取到当前状态下的游戏界面盒子的宽度及高度
//        var gamewidth = document.getElementById("gamebox").width;
//        var gameheight = document.getElementById("gamebox").height;
        //获取到创建画布的元素
        var canvas = document.getElementById("canvas");
//        canvas.width=gamewidth;
//        canvas.height=gameheight;
        //创建2d绘图环境
        var gc = canvas.getContext("2d");
        //填充颜色
//        gc.fillStyle = "#ccc";
        //创建数据
        function map(r,c) {
            var data = [];

            for(var i = 0;i < r;i++){
                data.push([]);
                for(var j = 0; j<c;j++){
                    data[i].push(0);
                }
            }
            return data;
        }
        //创建图形
        var data = map(12,12);
        //创建方块
        function render(data,gc) {
            //设置块的宽和高
            var w = 500/12;
            var h = 700/12;
            console.log(w);
            var rLen = data.length;
            var cLen =data[0].length;
            for(var i = 0; i< rLen;i++){
                for(var j = 0; j<cLen;j++){
                    gc.fillStyle=data[i][j]==0?'#ccc':'#3BCCC9';
                    gc.fillRect(j*w,i*h,w,h);
                }
            }
        }
        render(data,gc);
        //方块数据
        var arr=[
            [[1,1,1,1]],
            [[1,1],[1,1]],
            [[1,1,0],[0,1,1]],
            [[0,1,1],[1,1,0]],
            [[0,1,0],[1,1,1]],
            [[1,0,0],[1,1,1]],
            [[0,0,1],[1,1,1]]
        ];
        var y=0;
        var x=4;
        //随机一个方块数据
        function mold() {
            var num = Math.floor(Math.random()*7);
            return arr[num];
        }
        //创建方块
        function create(arr) {
            for(var i = 0;i < arr.length;i++){
                for(var j=0;j<arr[i].length;j++){
                    if(!data[i+y][j+x]){
                        data[i+y][j+x]=arr[i][j];
                    }
                }
            }
            render(data,gc);
        }
        //matrix 保存随机出来的方块，这样在运动中就可以一直使用同一个方块了。
        var matrix = mold();
        var timer = null;
        var onOff =false;
        var arrl=[];
        for(var i=0;i<12;i++){
            arrl.push(0);
        }
        create(matrix);
    </script>
</body>
</html>